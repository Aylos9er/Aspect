FROM geodynamics/aspect-tester:latest

LABEL maintainer <rene.gassmoeller@mailbox.org>

USER dealii

ENV DEAL_II_VERSION v9.2.0

RUN rm -rf ~/dealii-${DEAL_II_VERSION} && cd dealii-${DEAL_II_VERSION}-src && mkdir build && cd build && cmake -DDEAL_II_CXX_FLAGS_DEBUG='-O1' -DDEAL_II_WITH_MPI=ON -DDEAL_II_WITH_COMPLEX_VALUES=OFF -DDEAL_II_COMPONENT_EXAMPLES=OFF -DCMAKE_INSTALL_PREFIX=~/dealii-${DEAL_II_VERSION} -DCMAKE_BUILD_TYPE=Debug -GNinja ../ && ninja install && cp summary.log ~/dealii-${DEAL_II_VERSION}/summary.log && cd .. && rm -rf build
