# This test checks whether the viscoelastic bending beam benchmark
# run successfully. In particular, this benchmark is a good test to 
# ensure that a model using active particles to track both viscoelastic 
# stresses and lithologies, which affect material properties, works.

include $ASPECT_SOURCE_DIR/benchmarks/viscoelastic_bending_beam/viscoelastic_bending_beam.prm 

set End time         = 2e3
set Output directory = particle_interpolator_linear_least_squares_van_leer_viscoelastic_bending_beam
subsection Mesh refinement
  set Initial global refinement = 0
end
# Significantly reduce resolution 
subsection Geometry model
  set Model name = box
  subsection Box
    set X repetitions = 15
    set Y repetitions = 10
  end
end

# Compositional field names and methods
subsection Compositional fields
  set Number of fields = 4
  set Compositional field methods =           particles,           particles,           particles,         particles
  set Names of fields             =           stress_xx,           stress_yy,           stress_xy,              beam
  set Mapped particle properties  = stress_xx:stress_xx, stress_yy:stress_yy, stress_xy:stress_xy, beam:initial beam
end

# Post processing
subsection Postprocess
  set List of postprocessors = basic statistics, composition statistics, particles
  subsection Particles
    set Number of particles = 4.5e3
    set Minimum particles per cell  = 25
    set Maximum particles per cell  = 35
    set Load balancing strategy     = remove and add particles
    set List of particle properties = initial composition, elastic stress
    set Interpolation scheme        = linear least squares van leer limiter
    set Update ghost particles      = true
    set Particle generator name     = random uniform
    set Data output format          = none
    subsection Interpolator
      subsection Linear least squares van Leer
        set Use limiter for properties = false, false, false, true, false, false, false
        set Global particle property maximum = 1, 1, 1, 1, 1, 1, 1
        set Global particle property minimum = 0, 0, 0, 0, 0, 0, 0
      end
    end
  end
end

