# Set velocity field test parameter file

# set Additional shared libraries = libvofinterface.so

set Dimension                              = 2
set Start time                             = 0
set End time                               = 1
set Use years in output instead of seconds = false
set CFL number                             = 0.5

subsection Geometry model
  set Model name = box
  subsection Box
    set X extent = 1
    set Y extent = 1
  end
end


subsection Prescribed Stokes solution
  set Model name = function
  subsection Velocity function
    set Variable names = x,y,t

    set Function constants = pi=3.1415926535
    set Function expression = -0.5;0
  end
end

set Nonlinear solver scheme                = Advection only

subsection Initial conditions
  set Model name = function
end


subsection Gravity model
  set Model name = vertical

  subsection Vertical
    set Magnitude = 0
  end
end


subsection Material model
  set Model name = simple
end


subsection Mesh refinement
  set Initial global refinement                = 4
  set Initial adaptive refinement              = 0
  set Time steps between mesh refinement       = 0
end

############### Parameters describing what to do with the solution

subsection Postprocess
  set List of postprocessors = vof_interface

  subsection VOFInterface
    set Small volume = 1e-7
    set Number initialization samples = 1
    set Manufactured Solution = true
    set Number error samples = 32
    set Time between error estimates = 0.03125

    subsection Initial conditions
      set Variable names = x,y,t
      set Function constants = pi=3.1415926535, init=1.25, x0=1.0, y0=0.0, xv=-0.5, yv=0.0
      set Function expression = cos(init*pi)*(x-x0-xv*t)+sin(init*pi)*(y-y0-yv)
    end
  end
end

#subsection Compositional fields
#  set Number of fields = 1
#end
#
#subsection Compositional initial conditions
#  set Model name = function
#
#  subsection Function
#    set Variable names      = x,y
#    set Function expression = if(abs(x-0.5)<0.125, if(abs(y-0.5)<0.125, 1, 0), 0)
#  end
#end
